<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>components/admin/AdminGallery.vue - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Admin.html">Admin</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AdminGallery.html">AdminGallery</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AdminNavbar.html">AdminNavbar</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AdminProfile.html">AdminProfile</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-App.html">App</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AppButton.html">AppButton</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AppFooter.html">AppFooter</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AppNavbar.html">AppNavbar</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-AppTitle.html">AppTitle</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-ArtistItem.html">ArtistItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-ArtistList.html">ArtistList</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-ArtistProfile.html">ArtistProfile</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Artists.html">Artists</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-auth.html">auth</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-auth.html#~initLogin">initLogin</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-auth.html#~login">login</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-auth.html#~logout">logout</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-auth.html#~register">register</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Categories.html">Categories</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-CategoriesResults.html">CategoriesResults</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Conventions.html">Conventions</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-firebase.html">firebase</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-gallery.html">gallery</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-gallery.html#~deleteImage">deleteImage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-gallery.html#~getArtistGallery">getArtistGallery</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-gallery.html#~getGalleryFromId">getGalleryFromId</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-gallery.html#~setArtistGallery">setArtistGallery</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-gallery.html#~updateArtistGallery">updateArtistGallery</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-GalleryItem.html">GalleryItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-GeoResults.html">GeoResults</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-GlobalComponents.html">GlobalComponents</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Home.html">Home</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-HomeCategories.html">HomeCategories</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-HomeGeoloc.html">HomeGeoloc</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Login.html">Login</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-LoginForm.html">LoginForm</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-modules.html">modules</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-NavBrand.html">NavBrand</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-PreviewItem.html">PreviewItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-profile.html">profile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-profile.html#~getAllArtists">getAllArtists</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-profile.html#~getArtistById">getArtistById</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-profile.html#~getArtistProfile">getArtistProfile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-profile.html#~setArtistProfile">setArtistProfile</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-profile.html#~setArtistThumnail">setArtistThumnail</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-RegisterForm.html">RegisterForm</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-search.html">search</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-search.html#~getArtistsByCity">getArtistsByCity</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-search.html#~getArtistsByStyle">getArtistsByStyle</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Sidenav.html">Sidenav</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">components/admin/AdminGallery.vue</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>&lt;template>
  &lt;div class="row">
    &lt;div class="col-12 mb-4">
      &lt;app-title mode="title-img">Your gallery&lt;/app-title>
    &lt;/div>
    &lt;div class="col-12 btn-right mt-3">
      &lt;div class="btn-group mb-3" @click="setArtistGallery">
        &lt;app-button>Save&lt;/app-button>
      &lt;/div>
    &lt;/div>
    &lt;div class="col-12 mb-4">
      &lt;input
        type="file"
        accept="image/*"
        @change="handleChange($event)"
        multiple="true"
        ref="inputFile"
      />
    &lt;/div>
  &lt;/div>
  &lt;div class="row mb-3">
    &lt;div
      class="col-12 col-md-6 col-lg-4 col-xl-3"
      v-for="image in images"
      :key="image"
    >
      &lt;PreviewItem :image="image" @removePreview="removePreview" />
    &lt;/div>
  &lt;/div>
  &lt;div class="row">
    &lt;div
      class="col-12 col-md-6 col-lg-4 col-xl-3"
      v-for="(gallery, i) in profileGallery"
      :key="gallery"
    >
      &lt;GalleryItem :image="gallery" :index="i" @removeImg="removeImg" />
    &lt;/div>
  &lt;/div>
  &lt;div class="row" v-if="!images">
    &lt;div class="col-12 col-md-6 col-lg-4 col-xl-3">
      &lt;img :src="require('@/assets/img/default-placeholder.png')" />
    &lt;/div>
  &lt;/div>
&lt;/template>

&lt;script>
import GalleryItem from '@/components/admin/GalleryItem';
import PreviewItem from '@/components/admin/PreviewItem';

/**
 * @exports AdminGallery
 * @type {Component}
 * @vue-data {array} images - For previews
 * @vue-data {array} gallery - Current gallery in session
 * @vue-data {array} profileGallery - Current gallery in DB
 * @vue-event {array} getArtistGallery
 * @vue-event {array} handleChange
 * @vue-event {void} cleanCache
 * @vue-event {void} setArtistGallery
 * @vue-event {array} removeImg
 * @vue-event {array} removePreview
 */
export default {
  name: 'AdminGallery',
  components: {
    GalleryItem,
    PreviewItem,
  },
  data() {
    return {
      images: [],
      gallery: [],
      profileGallery: [],
    };
  },
  /**
   * @description Dispatch store action
   * Get the resulting state and set it as profileGallery
   * @method getArtistGallery
   * @returns {array} thumbnail
   * @async
   */
  async created() {
    await this.$store.dispatch('getArtistGallery').then(() => {
      const gallery = this.$store.state.gallery.gallery;
      this.profileGallery = gallery.gallery;
    });
  },
  methods: {
    /**
     * @description Call cleanCache
     * Create preview URL for each image selected
     * Set the resulting images to image array
     * @method getArtistGallery
     * @param {object} $event
     * @returns {array} images
     */
    handleChange($event) {
      this.cleanCache();
      const files = $event.target.files;
      this.gallery = files;
      const previews = [];
      if (files.length > 0) {
        for (let i = 0; i &lt; files.length; i++) {
          const pictureUrl = URL.createObjectURL(files.item(i));
          previews.push(pictureUrl);
        }
        this.images = previews;
      }
    },
    /**
     * @description Clean browser's image url cache for each URL created during the session
     * @method getArtistGallery
     * @param {object} $event
     * @returns {void}
     */
    cleanCache() {
      const previews = this.images;
      for (const i in previews) {
        if (previews[i].startsWith('blob:')) {
          URL.revokeObjectURL(previews[i]);
        }
      }
    },
    /**
     * @description Check if gallery already exists
     * If it does, dispatch updateArtistGallery
     * If it doesn't, dispatch setArtistGallery
     * @method setArtistGallery
     * @param {array} gallery
     * @returns {void} images
     * @async
     */
    async setArtistGallery() {
      if (this.profileGallery.length) {
        this.$store.dispatch('updateArtistGallery', this.gallery);
        return;
      }
      this.$store.dispatch('setArtistGallery', this.gallery);
    },
    /**
     * @description Remove item from current gallery array (to avoid window reload)
     * Dispatch deleteImage action
     * @method setArtistGallery
     * @param {array} profileGallery
     * @returns {array} profileGallery
     */
    removeImg(i) {
      this.profileGallery.splice(i, 1);
      this.$store.dispatch('deleteImage', this.profileGallery);
    },
    /**
     * @description Remove item from current image preview array (to avoid window reload)
     * @method setArtistGallery
     * @returns {array} images
     */
    removePreview(i) {
      this.images.splice(i, 1);
    },
  },
};
&lt;/script>
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Mon Nov 01 2021 10:10:02 GMT+0100 (Central European Standard Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
